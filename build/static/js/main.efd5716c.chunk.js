(this.webpackJsonpreact_chut2=this.webpackJsonpreact_chut2||[]).push([[0],{21:function(e,t,n){},23:function(e,t,n){},28:function(e,t,n){"use strict";n.r(t);var r=n(4),c=n.n(r),a=n(15),s=n.n(a),i=(n(21),n(12)),o=n(6),u=n.n(o),l=n(10),d=(n(23),n(1));var p=function(e){var t=function(e){var t=c.a.useState(e),n=Object(i.a)(t,2),r=n[0],a=n[1];function s(){a(new Date)}return c.a.useEffect((function(){var e=setInterval((function(){return s()}),1e3);return function(){clearInterval(e)}})),r}(new Date);return Object(d.jsx)("div",{children:Object(d.jsx)("h1",{className:"time",children:t.toLocaleTimeString()})})},h=n(9),b=(n(29),n(26),{apiKey:"AIzaSyA5ZNxod7Id7oQLNAPC8aDO7maOoNcR69U",authDomain:"chut2-c2958.firebaseapp.com",databaseURL:"https://chut2-c2958-default-rtdb.firebaseio.com",projectId:"chut2-c2958",storageBucket:"chut2-c2958.appspot.com",messagingSenderId:"861344867001",appId:"1:861344867001:web:01cf3be224a6a9ac743168"}),j=n(16);h.a.initializeApp(b);var f=h.a.auth(),x=h.a.firestore(),m=[];function O(){var e=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new h.a.auth.GoogleAuthProvider,e.next=3,f.signInWithPopup(t);case 3:x.collection("accounts").doc(f.currentUser.uid).get().then(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.exists){e.next=5;break}console.log("account exists"),h.a.firestore().collection("accounts").doc(f.currentUser.uid),e.next=9;break;case 5:return console.log("creating account..."),n={useruid:f.currentUser.uid,name:f.currentUser.displayName,email:f.currentUser.email,busStops:[]},e.next=9,h.a.firestore().collection("accounts").doc(f.currentUser.uid).set(n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{className:"time",children:"Welcome to Chut-Chut"}),Object(d.jsxs)("p",{className:"description",children:["This web app stores bus stop #s in"," ",Object(d.jsx)("a",{className:"description",href:"https://firebase.google.com/",children:"Google Firebase"})," ","to display"," ",Object(d.jsx)("a",{className:"description",href:"https://www.metrotransit.org/nextrip",children:"NexTrip"})," ","all in one page. I created this app for my fellow public commuters to conveniently check for arrival times because I am tired of waiting for the"," ",Object(d.jsx)("a",{className:"description",href:"https://www.metrotransit.org/",children:"MetroTransit app"})," ","to load. Sign in to start feeling convenient. Best performance on a mobile device."]})]}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{className:"sign-in",onClick:e,children:"Sign in with Google"})})]})}function v(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1];function a(){return(a=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("https://svc.metrotransit.org/NexTrip/".concat(n,"?format=json"));case 3:e.sent.ok?(m.push(n),x.collection("accounts").doc(f.currentUser.uid).get().then(function(){var e=Object(l.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.exists){e.next=5;break}return r=h.a.firestore().collection("accounts").doc(f.currentUser.uid),e.next=4,r.update({busStops:h.a.firestore.FieldValue.arrayUnion(n)});case 4:console.log("added ".concat(n));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.target.reset()):alert("".concat(n," is not a valid Metro Bus Stop ID."));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(d.jsxs)("form",{onSubmit:function(e){return a.apply(this,arguments)},children:[Object(d.jsx)("label",{className:"mr-sm-2",htmlFor:"busIDInput",children:"Add Metro Bus Stop ID"}),Object(d.jsx)("input",{type:"number",onChange:function(e){return c(e.target.value)},placeholder:"16086",maxLength:"5",max:"99999",min:"1",id:"busIDInput",required:!0}),Object(d.jsx)("button",{className:"add",type:"submit",disabled:!n,children:"Add"})]})}var g=0;function w(e){if(0==e.allStops.length){var t="Fetching bus stops...";return++g>=5?(t="No bus stops in database",Object(d.jsxs)("div",{children:[" ",Object(d.jsx)("h2",{children:"".concat(t)})]})):Object(d.jsxs)("div",{children:[" ",Object(d.jsx)("h2",{children:"".concat(t)})]})}return Object(d.jsx)("div",{children:e.allStops.map((function(t,n){return Object(d.jsxs)("div",{children:[Object(d.jsxs)("h2",{children:[Object(d.jsx)("a",{className:"a-btn",href:"https://www.metrotransit.org/nextrip/".concat(e.busStops[n]),target:"_blank",children:e.busStops[n]}),Object(d.jsx)("button",{className:"delete",type:"button",onClick:function(t){return r=e.busStops[n],m=m.filter((function(e){return e!==r})),void x.collection("accounts").doc(f.currentUser.uid).get().then(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.exists){e.next=4;break}return n=h.a.firestore().collection("accounts").doc(f.currentUser.uid),e.next=4,n.update({busStops:h.a.firestore.FieldValue.arrayRemove(r.toString())});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var r},children:"\u2715"})]}),Object(d.jsxs)("table",{children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{children:"Bus No."}),Object(d.jsx)("th",{children:"Time"})]})}),Object(d.jsx)("tbody",{children:t&&!t.length?Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:" - "}),Object(d.jsx)("td",{children:" - "})]}):t?t.slice(0,5).map((function(e,t){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{className:"td ".concat(e.Actual?"active":""),children:e.Route}),Object(d.jsx)("td",{className:"td ".concat(e.Actual?"active":""),children:e.DepartureText})]},"".concat(e.Route,"_").concat(e.DepartureTime,"_").concat(e.RouteDirection))})):void 0})]})]},"".concat(e.busStops[n],"_").concat(n))}))})}var N=function(){var e,t=Object(j.a)(f),n=Object(i.a)(t,1)[0],c=[[{Actual:!1,DepartureText:"Loading..."}]],a=Object(r.useState)([]),s=Object(i.a)(a,2),o=s[0],h=s[1],b=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return g(e)})));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://svc.metrotransit.org/NexTrip/".concat(t,"?format=json"));case 2:if(!(n=e.sent).ok){e.next=8;break}return e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(m);case 2:if(t=e.sent,h(t),!n||!f.currentUser.uid){e.next=9;break}return e.next=7,x.collection("accounts").doc(f.currentUser.uid).get();case 7:r=e.sent,m!==r.data().busStops&&m.length<=r.data().busStops.length&&(m=r.data().busStops);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function S(){return m=[],f.currentUser&&Object(d.jsx)("button",{type:"button",className:"sign-out",onClick:function(){f.signOut().then(h(c))},children:Object(d.jsx)("span",{className:"glyphicon glyphicon-log-out"})})}return Object(r.useEffect)((function(){if(n){var e=setInterval(Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N();case 1:case"end":return e.stop()}}),e)}))),1e3);return function(){clearInterval(e)}}}),[o,m,n]),Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)("header",{className:"App-header"}),n?Object(d.jsxs)("div",{className:"main-disp",children:[Object(d.jsx)(p,{}),Object(d.jsxs)("div",{children:[Object(d.jsxs)("h2",{children:["Hello ",f.currentUser.displayName," ",Object(d.jsx)(S,{})]}),Object(d.jsxs)("p",{className:"signed-in-with",children:["Signed in with ",f.currentUser.email]})]}),Object(d.jsx)(v,{}),Object(d.jsx)(w,{allStops:o,busStops:m},(e="","".concat(e,"_").concat((new Date).getTime())))]}):Object(d.jsx)(O,{})]})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(N,{})}),document.getElementById("root")),S()}},[[28,1,2]]]);
//# sourceMappingURL=main.efd5716c.chunk.js.map